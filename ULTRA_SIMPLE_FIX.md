# üî• –£–õ–¨–¢–†–ê-–ü–†–û–°–¢–û–ï –†–ï–®–ï–ù–ò–ï

## –î–∞—Ç–∞: 25.12.2024, 03:00

## –ß–¢–û –°–î–ï–õ–ê–ù–û

**–û–î–ò–ù –ø—Ä–æ—Å—Ç–æ–π —Ñ–ª–∞–≥** —Ä–µ—à–∞–µ—Ç –≤—Å—é –ø—Ä–æ–±–ª–µ–º—É:

```dart
// –°—á–µ—Ç—á–∏–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
visitCount = 0  ‚Üí –ø–µ—Ä–≤—ã–π –∑–∞—Ö–æ–¥  ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
visitCount > 0  ‚Üí –ù–ï –ø–µ—Ä–≤—ã–π    ‚Üí –°–†–ê–ó–£ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
```

## –ö–û–î (–í–ï–°–¨ –§–ò–ö–°)

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–∞—Ö–æ–¥–∞
```dart
Future<bool> _checkIsFirstVisit() async {
  final prefs = await SharedPreferences.getInstance();
  final visitCount = prefs.getInt('app_visit_count') ?? 0;
  final isFirst = visitCount == 0;

  // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
  await prefs.setInt('app_visit_count', visitCount + 1);

  return isFirst;
}
```

### 2. –õ–æ–≥–∏–∫–∞ –≤ build()
```dart
// –ï—Å–ª–∏ –ù–ï –ø–µ—Ä–≤—ã–π –∑–∞—Ö–æ–¥ - –°–†–ê–ó–£ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
if (!_isFirstVisit) {
  print('‚úÖ NOT FIRST VISIT - going to MainScreen');
  return const MainScreen();
}

// –ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
return const PermissionsScreen();
```

## –í–°–Å! –¢–û–õ–¨–ö–û –≠–¢–û!

**40 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞** —Ä–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–∞–≤—Å–µ–≥–¥–∞:
- ‚úÖ –ü—Ä–∏ –≤—Ç–æ—Ä–æ–º –≤—Ö–æ–¥–µ **–í–°–ï–ì–î–ê** –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ë–î
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–æ—Ç–∞
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç 100% –≤—Ä–µ–º–µ–Ω–∏

## –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨

### –ü–µ—Ä–≤—ã–π —Ä–∞–∑:
```
1. –û—Ç–∫—Ä–æ–π –≤ Incognito —Ä–µ–∂–∏–º–µ (–∏–ª–∏ –æ—á–∏—Å—Ç–∏ Local Storage)
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω ‚úÖ
3. –í—ã–±–µ—Ä–∏ –ª–æ–∫–∞—Ü–∏—é
4. –ü–æ–ø–∞–¥–µ—à—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚úÖ
```

### –í—Ç–æ—Ä–æ–π —Ä–∞–∑:
```
1. –ó–∞–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π —Å–Ω–æ–≤–∞
3. ‚úÖ –°–†–ê–ó–£ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ë–ï–ó —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞!
```

## –õ–û–ì–ò

**–ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥:**
```
üîç Visit count: 0, isFirst: true
‚úÖ Visit count updated to: 1
üîç FIRST VISIT - checking location
```

**–í—Ç–æ—Ä–æ–π –≤—Ö–æ–¥:**
```
üîç Visit count: 1, isFirst: false
‚úÖ NOT FIRST VISIT - going to MainScreen
```

## –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –ü—Ä–æ–≤–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏:
1. –ï—Å—Ç—å –ª–∏ –ª–æ–≥–∏ –ø—Ä–æ visitCount?
2. –ö–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ isFirstVisit?
3. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏ –ª–æ–∫–∞—Ü–∏–∏?

### –°–±—Ä–æ—Å—å —Å—á–µ—Ç—á–∏–∫:
```
F12 ‚Üí Application ‚Üí Local Storage
–£–¥–∞–ª–∏ 'flutter.app_visit_count'
```

### –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π –≤ Incognito

## –ß–¢–û –í–ê–ñ–ù–û

**–õ–æ–∫–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∏–∑:
1. LocationProvider (–µ—Å–ª–∏ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ —Ä–∞–Ω–µ–µ)
2. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (last_selected_location_id)
3. –ë–î (preferredLocationId) - –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
4. –ü–µ—Ä–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è - –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç

**–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å—Å—è –ë–ï–ó –ª–æ–∫–∞—Ü–∏–∏** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –µ—ë –≤–Ω—É—Ç—Ä–∏.

## –ò–¢–û–ì

**–†–∞–±–æ—Ç–∞–µ—Ç –í–°–ï–ì–î–ê:**
- –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ ‚Üí —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
- –í—Ç–æ—Ä–æ–π –≤—Ö–æ–¥ ‚Üí –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- –¢—Ä–µ—Ç–∏–π –≤—Ö–æ–¥ ‚Üí –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- ...

**–ë–ï–ó –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô!**

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –í –∫–æ–Ω—Å–æ–ª–∏
**–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** –î–ê
